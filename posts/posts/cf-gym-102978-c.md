---
title: CFgym102978C 题解 -【XXI Opencup GP of Tokyo】Count Min Ratio
---

> **题目大意.**
>
> 现有 $R$ 个红球，$B$ 个蓝球和一个绿球，同颜色的球不可区分。对于一种球的排列方式，记 $l_R$ 是绿球左边的红球数量，$l_B,r_R,r_B$ 类似。令这种排列方式的权值为
> $$
> \max x:x\in\mathbb N,l_Bx\le l_R\land r_Bx\le r_R
> $$
> 求所有排列方式的权值和。
>
> $R\le 10^{18},B\le 10^6$。

容易写出：
$$
\sum_{b=0}^B\sum_{r=0}^R{r+b\choose r,b}{R-r+B-b\choose R-r,B-b}\min(r/b,(R-r)/(B-b))
$$
其中认为 $x/0=+\infty$。

注意到 ${r+b\choose r,b}{R-r+B-b\choose R-r,B-b}$ 可以理解为所有从 $(0,0)$ 走到 $(R,B)$ 的仅向右和向上的且经过 $(r,b)$ 的路径的总数，下面我们就往这个模型的方向进行考量。

自然考虑 $R/r,B/b$ 皆大于等于 $x$ 是什么情况。