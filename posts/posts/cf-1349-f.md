---
title: CF1349F 题解 - Slime and Sequences
---

> **题意翻译.**
>
> [这里](https://www.luogu.com.cn/problem/CF1349F2)

# 世界线 1

题面直接给出的东西非常阴间非常神秘，考虑转化掉。

不妨让每个 $k$ 指向下一个 $k$，如果已经是最后一个 $k$ 就让它指向第一个 $k-1$，于是变成这样一个结构

<center><div style="width:60%;margin:0"><img src="https://xyix.gitee.io/images/cf-1349-f.png" style="width: 70%" alt=""></div></center>

显然这给出一个元素之间的全序关系。

再冷静观察一下就会发现，每个元素的权值恰好是它前面前向边的数量 +1。记全序链中排名为 $i$ 的元素的位置是 $p_i$，$i$ 的权值就是 $j<i$ 且 $p_j<p_{j+1}$ 的 $j$ 的数量 $+1$。

即，我们把问题转化成了

> **题目大意.**
>
> 记排列 $p$ 导出的大/小于号序列为 $s(p)$，有
> $$
> s(p)_i=\begin{cases}0&(i=1)\\ [p_{i-1}>p_i]&\text{otherwise}\end{cases}
> $$
> 记一个排列的权值为其导出的大/小于号序列中第 $k-1$ 个 $0$ 和第 $k$ 个 $0$ 之间的元素个数。对于任意的 $k$，求所有 $1\sim n$ 的排列的权值和。

# 世界线 2

题面直接给出的东西非常阴间非常神秘，但我们不考虑转化！!1

