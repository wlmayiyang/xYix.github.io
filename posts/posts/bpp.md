---
title: bijective proof problems 选做
---

[pdf 版本的题目表](https://xyix.gitee.io/images/bijective%20proof%20probs.pdf)

建 议 改 为：代 数 方 法 戒 毒 笔 记

**记号和笔记.**

- $Y^X=X\rightarrow Y$ 代表从集合 $X$ 到 $Y$ 的映射。
- $x\mapsto\xi$ 代表一个把元素 $x$ 映射到 $\xi$ 的映射。
- $C(S,m)$ 代表从 $S$ 的所有大小为 $m$ 的子集。当然也可以看作 $\{f\in\{0,1\}^S,\sum_{i=1}^nf(i)=m\}$。
- $[n]=\{1,2,...,n\}$。
<<<<<<< HEAD
- $\#S$ 表示集合 $S$ 的大小。
- 向量 $(c_1,c_2,...,c_n)$ 记为 $\mathbf c$。
=======
>>>>>>> 66be6e1edabd0c8110b18b47098b9c1a99de906e
- 既然是双射证明题集，此处所有题目的解答**只允许使用组合意义**，准确来说是 **bijective proof**（通过构造从 $S$ 到 $T$ 的双射来证明 $|S|=|T|$）。被禁止的手段包括但不限于
- - 归纳
  - 递归 / 递推
  - 生成函数
  - 组合恒等式，即使该组合恒等式可以用组合意义证明
<<<<<<< HEAD
- ~~事实上很大概率你也用不了（悲）~~
- 另外还要尽量使证明足够优雅。
- 有可能会插入一些 EC 里的好题。
=======
- 另外还要尽量使证明足够优雅。
>>>>>>> 66be6e1edabd0c8110b18b47098b9c1a99de906e
- 注意双射意味着**单**和**满**。单往往是显然的，满则等价于唯一可逆。

**题目难度解释.**

- $+$ 和 $-$ 表示微调。

- [1]：显然或直接。
- [2]：困难或比较技巧性。[2+] 是应当给研究生留的作业题的难度上界。 
- [3]：极其困难。一些学生可能能做出 [3-]。几乎没有人可以在合理的时间内做出 [3]。
- [4]：令人害怕地困难。
- [5]：尚未解决。（草）
- 此处难度皆标注以题单中标注的难度。

**5.[2]**

> **问题.**
>
> 分别求满足如下条件的有序列表 $(S_1,...,S_k)$ 的数量，其中 $S_i$ 皆为 $[n]$ 的子集。
>
> - $S_1\subseteq...\subseteq S_k$。
> - $S_i$ 两两不交。
> - $\bigcap S=\varnothing$。

> **解答.**
>
> 第一问：容易建立从 $\{1\sim k +1\}^{[n]}$ 到指定集合的双射：$f(i)$ 表示第 $i$ 个元素首次出现是在 $S_{f(i)}$，$f(i)=k+1$ 表示从未出现。
>
> 第二问：显然可以建立到第一问的双射：$S_i\mapsto S_{i}/S_{i-1}$。
>
> 第三问：显然可以建立到一组 $\bigcup S=[n]$  的集合的双射：$S_i\mapsto [n]/S_i$。而后者可以按和之前类似的方法建立到 $([k] 的非空子集)^{[n]}$ 的双射。
>
> $\blacksquare$

开胃小菜，没啥好说的。

话说这不应该是 [1]？

**12.[2-]**

> **问题.**
>
> 证明
> $$
> \sum_{k=0}^n{x+k\choose k}={x+n+1\choose n}
> $$
> 不妨假定 $x$ 为正整数。（因为等式两边都是关于 $x$ 的有限次多项式，证明了正整数的情况也就证明了一般情况）

> **解答.**
>
> 考虑集合 $C([x+n+1],n)$，我们的目的是将其元素 $\mathbf S$ 用如下二元组描述：$(k, S)$，其中 $S\in C(x+k,k)$。
>
> 这一双射是显然的，我们只需要令 $n-k$ 等于 $\mathbf S$ 中末尾那一长串 $1$ 的长度，$S$ 为剩下的 $[x+k]$ 的情况。注意 $\mathbf S(x+k+1)$ 必定为 $0$，不需要也不能用 $S$ 描述。
>
> $\blacksquare$

**13.[3]**

> **问题.**
>
> 证明
> $$
> \sum_{k=0}^n{2k\choose k}{2(n-k)\choose n-k}=4^n
> $$

> **解答.**
>
> 注意到 $2n\choose n$ 是从 $(0,0)$ 走到 $(n,n)$，每一步只能向上一步或是向右一步的方案数（该双射是显然的）。
>
> 于是等式右边可解释为：从 $(0,0)$ 开始走 $2n$ 步，不限目的地的方案数。一个方案可以双射到三元组：$(k,S,T)$，其中 $S$ 是一条从 $(0,0)$ 到 $(k,k)$ 的路径，$T$ 是一条从 $(0,0)$ 开始走 $2n-2k$ 步且除了 $(0,0) $**从未**触碰 $y=x$ 的路径。换句话说，$k$ 标记出了它最后一次触碰 $y=x$ 的位置。
>
> 我们只需要说明，$T$ 的数量为 ${2(n-k)\choose n-k}$。这一部分的说明不是我的解法而是来自于[这里](https://www.quora.com/How-do-I-prove-that-sum_-k-0-n-binom-2k-k-binom-2n-2k-n-k-4-n/answer/Luke-Gustafson)。
>
> > 长度为 $2n$ 的所有路径可被分为 $4$ 类：
> >
> > - $T$ 的一员
> > - $S$ 的一员
> > - 触碰过 $y=x$ 并在最后处在 $y=x$ 右方
> > - 触碰过 $y=x$ 并在最后处在 $y=x$ 上方
> >
> > 显然，第一步往右走的第三类和第一步往右走的第四类数量相等，往上走亦然。关键之处在于，第一步往右走的第四类和第一步往上走的第三类是极易考虑的：它们的定义保证了它们必然触碰过 $y=x$，不需要再做考虑。
> >
> > 剩下只是一些处理组合数的工作，略去不谈。
>
> $\blacksquare$

有趣的是一位老哥头铁地直接构造了一个从 $S$ 到 $T$ 的[双射](https://math.stackexchange.com/a/72661)。

**14.[3-]**

> **问题.**
>
> 证明
> $$
> \sum_{i=0}^{\min(a,b)}{x+y+i\choose i}{y\choose a-i}{x\choose b-i}={x+a\choose b}{y+b\choose a}
> $$

> **解答.**
>
> 不妨改为证明
> $$
> \sum_{i=0}^{\min(a,b)}{x+y+i\choose x,y,i}{y\choose a-i}{x\choose b-i}={x+y\choose x}{x+a\choose b}{y+b\choose a}
> $$
> 左式可以化为这样一个模型，你在一个 $4$ 维网格上走动，每次可以选择
>
> - $(0,1,0,1)$
> - $(1,0,0,0)$
> - $(1,1,0,0)$
> - $(0,0,1,0)$
> - $(0,0,1,1)$
>
> 之一，最后走到 $(x,a,y,b)$。求总方案数。
>
> 当然也可以看成，往四个可区分的盒子里放任意多个有标号的球，要求第二个盒子和第三个球数之和为 $x$，第一个和第三个为 $a$，第一个和第五个为 $b$，第四个和第五个为 $y$。
>
> 然后到这里我就做不下去了……还是 EIls 靠谱。
>
> <div style="width:70%;margin:auto"><img src="https://xyix.gitee.io/images/bpp1.png" alt=""></div>
>
> 其实和上面的思路是一样的，但是 EIls 的解释确实更容易联系到右式。剩下的工作已经很显然了。
>
> $\blacksquare$

**15.[3-]**

> **问题.**
>
> 证明
> $$
> \sum_{k=0}^n{n\choose k}^2x^k=\sum_{k=0}^n{2n-k\choose n-k,n-k,k}(x-1)^k
> $$

> **解答.**
>
> 等式左边可理解为三元组 $(S,T,f)$，其中 $S,T\subseteq [n]$ 且大小相等，$f$ 是从 $S$ 到 $[x]$ 的映射。
>
> 右边则可理解为三元组 $(S',T',f')$，其中 $S'\subseteq[n]$，$T'\in C([2n]/S,n)$，$f'$ 是从 $S'$ 到 $[x-1]$ 的映射。
>
> 如此构造映射 $(S,T,f)\mapsto(S',T',f')$：
>
> > 令 $S'=f^{-1}([x-1])$；
> >
> > $f'$ 自然是 $f$ 在 $S'$ 上的限制；
> >
> > 令 $T'$ 在 $[n]$ 的部分为 $[n]/S$，在 $[n+1....2n]$ 的部分为 $T$ 平移到此处。
>
> $\blacksquare$

**16.[3-]**

> **问题.**
>
> 证明
> $$
> \sum_{i+j+k=n}{i+j\choose i}{j+k\choose j}{k+i\choose k}=\sum_{r=0}^n{2r\choose r}
> $$

> **解答.**
>
> 不会，贺了题解。
>
> 左式可理解为如下三元组 $(\alpha,\beta,\gamma)$ 的数量：
>
> - $\alpha$ 是一个以 $\text{a}$ 开头以 $\text{b}$ 结尾的字符串，恰有 $i+1$ 个 $\text{a}$ 和 $j+1$ 个 $\text{b}$。
> - $\beta$ 是一个长度为 $j+1$ 的正整数序列且和恰为 $j+k+1$。
> - $\gamma$ 是一个长度为 $i+1$ 的正整数序列且和恰为 $i+k+1$。
>
> 做如下映射：
>
> - 将 $\alpha$ 的第 $i$ 个 $\text{a}$ 替换为 $\text{c}^{\gamma_i}\text{d}$，第 $i$ 个 $b$ 替换为 $\text{d}^{\beta_i}\text{c}$。其中 $\text{c}^r$ 表示 $r$ 个 $\text{c}$。
> - 此时 $\alpha$ 必以 $\text{c}$ 开头，以 $\text{d}(\text{dc})^r$（满足该形式的后缀显然是唯一的）的形式结尾。删掉它们。
>
> 这构建了一个从左到右的双射。
>
> $\blacksquare$

就离谱，这双射是人能想出来的？建议评分 [3+]

<<<<<<< HEAD
**教程关：置换和循环.**

> **问题.**
>
> 给出序列 $(c_1,c_2,...,c_n)$。证明，有 $c_1$ 个长度为 $1$ 的循环，有 $c_2$ 个长度为 $2$ 的循环，……，的 $[n]\rightarrow [n]$ 的置换的数量为
> $$
> {n\choose c_1,c_2,...,c_n}\prod_{i}\dfrac{1}{i^{c_i}}
> $$

> **解答.**
>
> 记题目描述中的所有置换构成集合 $\mathfrak S^{\mathbf c}_{[n]}$，这种置换称为类型为 $\mathbf c$ 的置换。
>
> 故而只需要证明
> $$
> n!=\#\mathfrak S^{\mathbf c}_{[n]}\prod_{i}i^{c_i}c_i!
> $$
> 首先我们先展示一个从 $\mathfrak S_{[n]}$ 到自身的双射，被称为**基本双射**。
>
> > 将 $w$ 的所有循环写为以其最大元素开头，称为代表元素，然后以代表元素的大小排列各循环。最后删掉括号。
> >
> > 例：$w=4271367=(14)(2)(375)(6)$ 会被映射到 $2416753$。
>
> 我们有一个显然的 $\mathfrak S_{[n]}\rightarrow\mathfrak S_{[n]}^{\mathbf c}$ 的映射：把它开头的 $c_1$ 个元素每个套上一个括号，剩下部分开头的 $2c_2$ 个元素每 $2$ 个套一个括号……。我们只需要说明一个类型为 $\mathbf c$ 的置换的原像大小总是 $\prod_{i}i^{c_i}c_i!$。
>
> > 先从任意一个原像出发。首先我们可以任意排列长度相等的循环，然后每个循环还可以旋转，显然这样生成的所有排列两两不同，于是便得证了。
>
> $\blacksquare$

**EC 117.[2+]**

> **问题.**
>
> 从 $[n]$ 的所有排列中等概率随机一个排列 $w$，求 $1$ 所在循环大小为 $k$ 的概率。

> **解答.**
>
> 答案为：与 $k$ 无关，皆为 $\frac 1n$。
>
> 我们考虑把一个循环转变为，把 $1$ 所在循环固定在其首位且以 $1$ 为代表，剩下的部分遵从基本双射接在其后。容易发现对于任意确定的 $k$，上述映射构成了从 $1$ 所在循环大小为 $k$ 的排列到 $[n-1]$ 的排列的双射。
>
> $\blacksquare$

**EC 120.[2+]**

> **问题.**
>
> 令 $E_k(n)$ 为 $[n]$ 的排列中长度为 $k$ 的循环数量的期望。证明，$E_k(n)=\dfrac{1}{k}$。

> **解答.**
>
> 由 117 直接得 $E_k(n)=\dfrac 1k\sum_{i=1}P(i 所在循环大小为 k)=\dfrac 1k$。
>
> $\blacksquare$

=======
>>>>>>> 66be6e1edabd0c8110b18b47098b9c1a99de906e
**18.[3]**

> **问题.**
>
> 证明，当 $n$ 为质数时，下面两个集合的元素个数相等。
>
> - 所有满足其和在模 $n$ 意义下为 $0$ 的 $[0...n-1]$ 的子集
>
> - 所有有 $n$ 个珠子的黑白项链在旋转变换下的等价类

> **解答.**
>
> 我们来证明两者皆是 $\dfrac{2(n-1)+2^n}n$。
>
> 后者比较显然。
>
> > 取所有等价类，考虑其在所有旋转下的像（$\times n$），这个集合“几乎”是 $[2]^{[n]}$：
> >
> > - 显然两个不同等价类形成的像不会相同
> > - 但是一个等价类的像可能和同一个等价类的另一个像相同，由于 $n$ 是质数，这种情况只在该项链全黑或全白时出现，减掉即可
> >
> > 稍微扩展一下便是 Burnside 引理的一个组合证明。
>
> 再来考虑前者。
>
> > 考虑所有大小为 $i$ 的集合。考虑这样一个映射：把集合中所有元素加上 $1$ 再取模。
> >
> > 在 $i\neq 0\land i\neq n$ 的普通情形下这是一个从所有大小为 $i$ 的 $[0...n-1]$ 的子集回到自身的双射。且和为 $d$ 的集合总会被映射到和为 $d+i\bmod n$ 的集合，从而它们的元素个数相等。即两两
> >
> > 只是在 $i=0\lor i = n$ 时不成立，特判即可。
>
> $\blacksquare$

原题要求证明任意奇数的情况，所以评到了 [3]。原话：This is easy if n is prime.

<<<<<<< HEAD
被 D 傻了（悲）

**21.[2]**
=======
**21.**
>>>>>>> 66be6e1edabd0c8110b18b47098b9c1a99de906e

> **题目.**
>
> 证明如果 $p$ 是质数，$a^p-a$ 在模 $p$ 意义下为 $0$。

<<<<<<< HEAD
> **解答.**
>
> 大体思路是，选取一个大小为 $a^p-a$ 的集合，然后将其分为数份，每份大小均为 $p$。
>
> 一个显然的想法是令 $S$ 为所有 $[a]^{[p]}$ 中值不全相同的映射。
>
> 相信读者对 18 一定还有印象，于是一个显然的分组是把所有循环同构的映射分为一类。
>
> $\blacksquare$

**22.a.[2]**

> **题目.**
>
> 证明，如果 $p$ 是质数，那么 ${2p\choose p}-2$ 被 $p^2$ 整除。

> **解答.**
>
> 构造集合 $S$ 为所有从 $(0,0)$ 开始，每次可往右或往上走一步，走到 $(p,p)$，且不完全贴着边框走的方案数。
>
> 于是只需要把对前 $p$ 步的右-上序列施以循环变换，后 $p$ 步施以一个独立的循环变换：在这种意义下同构的序列被分为一组。每组大小皆为 $p^2$，得证。
>
> $\blacksquare$

**教程关：逆序对，Descents，和 Major index.**

> **定义.**
>
> - 逆序对对我们而言是很熟悉的。一个排列的逆序对数记为 $\text{inv}(w)$。
> - 一个排列的 Descents（可译为“下降”）Set 是集合 $D(w)=\{w_i>w_{i+1},i\in[n-1]\}$。
> - $\text{maj}(w)=\sum_{i\in D(w)}i$。

> **题目.**
>
> 证明
> $$
> \#\{w\in\mathfrak S_n,\text{inv}(w)=k\}=\#\{w\in\mathfrak S_n,\text{maj}(w)=k\}
> $$

**解答.**

此处的证明并不是完全双射的，~~[A direct bijective proof would be of great interest.jpg](https://www.luogu.com.cn/blog/zyxxs/bijective-proof-problems-zhong-di-yi-suo-sheng-cao-ping-lun)~~，这种类型的双射被称为 recursive bijection。

> 下面构造双射 $\phi:\{w\in\mathfrak S_n,\text{maj}(w)=k\}\rightarrow\{w\in\mathfrak S_n,\text{inv}(w)=k\}$。
>
> 取 $\text{maj}(w)=k$ 的 $w$。令 $v=\phi((w_1,w_2,...,w_{n-1}))$。
>
> 在 $v$ 的基础上如此构造 $\phi(w)$：
>
> - 如果 $w_{n-1}<w_n$：
> - - 在 $\phi(w)$ 中所有小于 $w_n$ 的位置后面切一刀。
>   - 把所有部分向右循环移一位。
> - 否则，
> - - 在 $\phi(w)$ 中所有大于 $w_n$ 的位置后面切一刀。
>   - 把所有部分向右循环移一位。
> - 最后令 $\phi_{n}(w)=w_n$。
>
> 接下来我们来展示，$\text{maj}(w)=\text{inv}(\phi(w))$。
>
> > 

=======
>>>>>>> 66be6e1edabd0c8110b18b47098b9c1a99de906e
