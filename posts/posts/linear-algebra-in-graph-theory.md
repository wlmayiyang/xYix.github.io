---
title: 图论中的线性代数 - 论文解析
---

不知道这算是不务正业还是务了正业呢

# 1. LGV 引理和特殊图最大流

见[此处](https://xyix.gitee.io/posts/?&postname=loj-6759)。

# 2. 矩阵树定理

记 $[n]=\{1,2,...,n\}$。

记 $A_{S,T}$ 为矩阵 $A$ 只保留标号在 $S$ 中的行和标号在 $T$ 中的列得到的子矩阵。当 $S=T$，它就是 $A$ 的一个主子式。

记矩阵 $A$ 的行列式为 $|A|$。

## 2.1. 柯西 - 比内公式

> **定理 1. (Cauchy-Binet)**
>
> 现有一个 $n\times m$ 的矩阵 $A$ 和一个 $m\times n$ 的矩阵 $B$，则
> $$
> |AB|=\sum_{S\subseteq [m],|S|=n}|A_{[n],S}||B_{S,[n]}|
> $$

> **证明.**
>
> 构造一个 $2n+m$ 个点的图，点分别称为 $u_1,...,u_n,v_1,...,v_m,w_1,...,w_n$。图中存在两种边：一种 $u_i\rightarrow v_j$，权值为 $a_{i,j}$；一种 $v_i\rightarrow w_j$，权值为 $b_{i,j}$。
>
> 我们注意到，根据 LGV 引理，$|AB|$ 就是所有 $u$ 到 $v$ 的不交路径组的带符号（所对应的置换的符号）权值和，左式亦类似。于是左式和右式的对应就极为显然了。

## 2.2. 矩阵树定理

由于已经非常普及，不赘述拉普拉斯矩阵的定义。下面我们来证明

> **定理 2. (Kirchhoff's Matrix Tree)**
>
> 一个带权无向图的拉普拉斯矩阵的任意一个代数余子式都等于该图中所有生成树的权值和。

> **证明.**
>
> 设删去的是第 $I$ 行第 $J$ 列。
>
> 考虑下面这个 $|V|\times|E|$ 的矩阵 $A$：对于每条边 $(u_i,v_i,w_i)$，其中 $u_i<v_i$，令 $a_{u_i,i}=-\sqrt{w_i}$，而 $a_{v_i,i}=\sqrt{w_i}$，矩阵的其他地方全为 $0$。易见，$A\times (A^T)$ 就是原图的拉普拉斯矩阵。
>
> 那么，删去 $A$ 的第 $I$ 行和 $A^T$ 的第 $J$ 列再令它们相乘就得到了所欲得的子矩阵。
>
> 于是应用柯西 - 比内公式。两个行列式的含义都是：令所有不同于 $I/J$ 的点各自选择一条 $S$ 中的边作为它的父亲。
>
> 根据某[经典对合](https://x-yi-x.blog.uoj.ac/blog/6511)，$S$ 一旦有环贡献就是 $0$，故它只能是一棵树，其行列式自然也就是 $\pm \prod_{e\in S} \sqrt{w_e}$（只有一个排列非零）。又可以证明这两个行列式符号相等，这就得到了矩阵树定理。

## 2.3. k - 生成森林

建虚点 $0$，向每个点连权值为 $x$（不定元）的边即可。注意这实际上就是此图的拉普拉斯矩阵的特征多项式。

# 3. 矩阵树定理的扩展

通过调整 $A$ 和 $A^T$，我们可以让它们完成我们想要的功能，从而解决其他一些问题，例如：

- 内外向树形图计数
- 无向图欧拉回路计数
- 最大非二分子图（需要结合随机化）
- 线性拟阵的交

这里不再列出对应的 $A$ 和 $A^T$，想了解的读者可以看原文。

# 4. 图的积

两个矩阵 $A,B$ 的 **Kronecker 积** 定义如下：
$$
A\otimes B=\begin{bmatrix}a_{1,1}B&\cdots&a_{1,n}B\\\vdots&\ddots&\vdots\\a_{n,1}B&\cdots&a_{n,n}B\end{bmatrix}
$$
Kronecker 积有一个有益的性质：
$$
(A\otimes B)(C\otimes D)=(AC)\otimes(BD)
$$
而两个矩阵的 **Kronecker 和** 定义为
$$
A\oplus B=A\otimes I_m+I_n\otimes B
$$
这两个运算分别叫做"积"和"和"是有深意的。考虑 $A$ 的特征向量 $x$ 和它对应的特征值 $\lambda$，$B$ 的 $y$ 和 $\mu$。
$$
(A\otimes B)(x\otimes y)=(Ax)\otimes(By)=(\lambda x)\otimes(\mu y)=\lambda\mu(x\otimes y)
$$
即，一对分别在 $A$ 和 $B$ 上的特征向量引出一对在 $A\otimes B$ 上的特征向量，且特征值是它们特征值的积。

同理有一样的推导：一对分别在 $A$ 和 $B$ 上的特征向量引出一对在 $A\oplus B$ 上的特征向量，且特征值是它们特征值的和。

## 4.1. 张量积，即邻接矩阵的 Kronecker 积

两张图 $(V_1,E_1),(V_2,E_2)$ 的**张量积** $(V,E)$ 为

- $V=\{(u_1\in V_1,u_2\in V_2)\}$
- $E=\{((u_1,u_2),(v_1,v_2))|(u_1,v_1)\in E_1,(u_2,v_2)\in E_2\}$

记作 $(V,E)=(V_1,E_1)\times(V_2,E_2)$。

显然，图的张量积就是邻接矩阵的 Kronecker 积。

## 4.2. 笛卡尔积，即邻接矩阵的 Kronecker 和

两张图 $(V_1,E_1),(V_2,E_2)$ 的**笛卡尔积** $(V,E)$ 为

- $V=\{(u_1\in V_1,u_2\in V_2)\}$
- $E=\{((u_1,u_2),(v_1,u_2))|(u_1,v_1)\in E_1\}\cup\{((u_1,u_2),(u_1,v_2))|(u_2,v_2)\in E_2\}$

记作 $(V,E)=(V_1,E_1)\square(V_2,E_2)$。

显然，图的笛卡尔积就是邻接矩阵的 Kronecker 和。

于是，我们可以较为容易地解决与图的积相关的生成树计数问题。

