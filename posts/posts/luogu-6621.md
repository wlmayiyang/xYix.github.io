---
title: luoguP6621 题解 - 【省选联考 2020 A 卷】魔法商店
---

> **题目大意.**
>
> 现在有 $n$ 个元素，每个元素有一个特征值 $x_i$（一个长度为 $64$ 的在域 $\mathbb F_2$ 上的向量）和权值 $w_i$。
>
> 定义：一个**合法元素组**是一个元素的集合，其中元素的特征值互不线性相关。
>
> 你要重新安排每个元素的权值 $v_i$，使得一个给定的合法元素组 $A$ 是所有合法元素组中权值最小的， $B$ 是最大的。
>
> 在满足以上要求的情况下，你还要使得回归代价 $\sum (w_i-v_i)^2$ 最小。
>
> $n\le 1000$。