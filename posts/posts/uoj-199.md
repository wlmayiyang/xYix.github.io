---
title: uoj#199 题解 - 【CTSC2016】萨菲克斯·阿瑞
---

> **题目大意.**
>
> 对于所有长度为 $n$，字符集为 $1\sim m$，且字符 $i$ 出现了不超过 $c_i$ 的字符串做后缀排序，求有多少种不同的后缀数组。
>
> $n,m\le 500$。时限 5s。

我们用一个后缀的开头下标来代表它。

# 1.

我们自然考虑两个在后缀排序后相邻的后缀 $\text{SA}(i),\text{SA}(i+1)$。我们自然要有 $s\left[\text{SA}(i)\right]\le s\left[\text{SA}(i+1)\right]$










$$
\text{calc}(n)=1/n\cdot\sum_{i=1}^{n}C^{\text{gcd}(i,n)}\\
=1/n\cdot\sum_{d|n}C^d\sum_{i=1}^{n/d}\sum_{g|i,g|(n/d)}\mu(g)\\
=1/n\cdot\sum_{dg|n}C^d\mu(g)n/dg
$$

$$
F(i)=\sum_{n=1}^N1/n\sum_{dge|n}\mu(e)\cdot e\cdot C^d\cdot \mu(g)\cdot n/dge\\=\sum_{n=1}^N\sum_{d|n}C^d/d\mu(n/d)/n/d
$$

$$
\mu*C^i*(\mu\cdot i)*\text{id}
$$

$$
\sum_{n=1}^N\sum_{d|n}C^{n/d}f(d)\\
\sum_{d=1}^N\mu(d)/d\sum_{n=1}^{N/d}C^n/n
$$

