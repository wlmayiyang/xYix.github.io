---
title: luoguP5404 题解 - 【CTS2019】重复
---

> **题目大意.**
>
> 给定一个长度为 $n$ 的串 $s$。
>
> 问：有多少个长度为 $m$ 的串，使得 $t^{\infty}$ 的任何一个长度为 $n$ 的子串都 $\ge s$。
>
> $|\Sigma|=26,n,m\le 2000$。

首先我们显然可以把 $s$ 的长度补成 $m$，这样可以简洁一些。现在所问的就是

> 有多少个长度为 $m$ 的串 $t$，使得其任何一个循环移位都 $\ge s$。

自然先考虑判定某个具体的 $t$ 是否合法。我们直接大力把 $t$ 的所有循环移位放在 $s$ 上跑！现在我们让它们一起匹配 $s_i$，那看起来大概就是这样：

<div style="width:70%;margin:auto"><img src="https://xyix.gitee.io/images/luogu-5404.png" alt=""></div>