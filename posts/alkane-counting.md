---
title: 烷烃计数
date: 2020-06-06 09:23:32
tags:
- 数学
- 计数
- 生成函数
- 多项式
---

任何点的度数小于等于 $4$ 的无标号无根树个数。

<!--more-->

# 烷基计数

我们先来数烷基。（任何节点均最多只有三个儿子的无标号有根树）

设 $f_i$ 是 $i$ 个点的烷基个数。有标号情况下的 ``DP`` 非常显然：

$$f_n=\sum_{i+j+k+1=n}f_if_jf_k$$

用 ``Burnside引理`` 可以得到无标号情况下的 ``DP``：

$$f_n=\dfrac 16\left(\sum_{i+j+k+1=n}f_if_jf_k+3\sum_{2i+j+1=n}f_if_j+2\sum_{3i+1=n}f_i\right)$$

写成 ``OGF`` 就是

$$F(x)=\dfrac x6(F(x)^3+3F(x^2)F(x)+2F(x^3))+1$$

牛迭即可。

# 烷烃计数

还是考虑重心的套路。

有一个结论：一棵树点等价类的数量 $p$（点的等价可以理解为将其定为根后整棵树的等价）减边等价类的数量 $q$ 加上 $[\text{其重心的数量为 }2]$（记为 $s$）等于 $1$。

容易发现所有不同构无根树的 $p$ 之和其实就是有根树的数量。类似烷基的式子，不过儿子数为 4。

$$P(x)=\dfrac x{24}(F(x)^4+8F(x^3)F(x)+3F(x^2)^2+6F(x^2)F(x)^2+6F(x^4))$$

所有 $q$ 之和就是两个烷基拼起来。注意特判 $n=0$。

$$Q(x)=\dfrac{(F(x)-1)^2+F(x^2)-1}{2}$$

$s$ 也很显然：有两个重心的无根树必然是两个大小相等的烷基拼起来。

$$S(x)=F(x^2)$$

于是烷烃数量即为

$$P(x)-Q(x)+S(x)$$