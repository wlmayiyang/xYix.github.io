---
title: 有标号仙人掌计数
date: 2020-06-09 07:51:09
tags:
- 数学
- 计数
- 生成函数
- 多项式
---

每条边最多仅在一个环上的有标号无向图个数。

<!--more-->

显然有标号无根图（相当于钦定根为 $1$）的数量是对应的有标号有根图的 $\frac 1 n$，所以下面我们只讨论有根仙人掌。

枚举根的每个“儿子”，一个“儿子”可能与根以一条边相连（一棵仙人掌，$F(x)$），也有可能由一个环相连（如果环的大小为 $i$，其下方可以接上 $i-1$ 棵仙人掌，又由于环可以翻转，所以生成函数即为 $\frac {F^{i-1}(x)}2$）。

所以有：

$$
F(x)=x\text{exp}\left(\dfrac{F(x)}2+\sum_{i=1}^{\infty}\dfrac{F^i(x)}2\right)
$$

$$
F(x)=x\text{exp}\left(\dfrac{F(x)}2+\dfrac{1}{2-2F(x)}-\dfrac 1 2\right)
$$

$$
F(x)=x\text{exp}\left(\dfrac{-F^2(x)+2F(x)}{2-2F(x)}\right)
$$

构造函数 $A(X)=X\exp(\dfrac{-X^2+2X}{2-2X})-X$，多项式牛迭即可。