---
luoguP5666 题解 - CSP2019 树的重心
---

考虑分割出来的两个部分必然是一个子树和一个“子树补”。

- 子树的情况

从重儿子继承重心暴力跳。由于加一个点最多让重心移动 1 步，而这个东西类似 dsu on tree 所以复杂度显然 $O(n\log n)$。据说能证到 $O(n)$，不管了。

- 子树补的情况

那么我们就有两种选择了，从父亲推到儿子还是从儿子推到父亲。但显然从父亲推到儿子会爆炸，比如链底接一个菊花。

那考虑从儿子推到父亲。那么问题来了我们该继承哪个儿子呢？显然从儿子到父亲会导致重心“远离”这棵子树，我们选最远的那个大概就行了。但是“远离”很难描述。

高妙做法是选整棵树的重心当根，这样子树补的重心一定在根的另一个子树中，而且一条向下的链的子树补的重心正好形成一条向上的链（不会越过根）

