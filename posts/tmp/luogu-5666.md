---
luoguP5666 题解 - CSP2019 树的重心
---

考虑分割出来的两个部分必然是一个子树和一个“子树补”。

- 子树的情况

从重儿子继承重心暴力跳。由于加一个点最多让重心移动 1 步，而这个东西类似 dsu on tree 所以复杂度显然 $O(n\log n)$。据说能证到 $O(n)$，不管了。

- 子树补的情况