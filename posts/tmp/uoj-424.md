---
title: uoj#424 - 【集训队作业2018】count
---

之前科研尼克讲过，但是我鸽了。

> **题目大意.** 一个挺好序列指的是一个长度为 $n$，序列中元素均为 $[1...m]$ 之间的正整数，且 $[1...m]$ 恰好都出现过的序列。称两个序列 $A,B$ 同构是说：
> $$
> \forall l\le r,\max_{[l,r]}a=\max_{[l,r]}b
> $$
> 其中 $\max$ 表示，权值最大且权值相同时下标最小的元素的**下标**。求有多少互不同构的序列。$n, m\le 10^5$。

首先介绍**笛卡尔树**。笛卡尔树是二叉树，满足堆序（根大于所有儿子），且中序遍历的结果为原序列。可见 $\max_{[l,r]}$ 即笛卡尔树上 $l,r$ 的 LCA。从而，两个序列同构，意味着其笛卡尔树同构。