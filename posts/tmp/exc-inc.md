---
title: 容斥符号化 - 更炫酷的反演魔术
---

对之前那篇组合对象符号化的补充。太震撼了。

# 例子：错排问题

考虑所有置换构成的组合类 $\mathcal P$。构造 $\mathcal Q$ 是这样的一个组合类，其中元素都是置换，而我们还可以标记一些不动点。也就是说，同一个置换但是一个不动点标不标记是两个在 $\mathcal Q$ 中的对象。$\mathcal Q$ 是容易计数的：标记的点必须守序（标号为 $1,2,3,...$，毕竟它们是不动点）而其他点不必，从而有
$$
\mathcal Q=\text{SET}(\mathcal Z)\star\mathcal P
$$
我们在 GF 中用一个新的变元 $u$ 指出 $\mathcal Q$ 中元素的标记点的数量：
$$
Q(u,z)=\dfrac{e^{uz}}{1-z}
$$
我们还是用 $u$ 指出 $\mathcal P$ 中**不动点**的数量，显然 $\mathcal P$ 中的不动点（一个 $u$ 的贡献）都可以选择标记和不被标记，即贡献 $u$ 或贡献 $1$。从而通过这个 $u\to u+1$ 立即得到
$$
Q(u,z)=P(u+1,z)
$$

$$
P(0,z)=\dfrac{e^{-z}}{1-z}
$$

问题得到解决。

从这个问题中看不大出容斥符号化的优越性。我们举一个更劲爆的例子。

# 例子：莫比乌斯反演

我们有
$$
f_n=\sum_{d|n}g_d
$$
则 $g=?$

首先明确，一个整数可以看成它的质因子分解序列，比如 $12=(2,1,0,0...)$ 我们把整个序列作为它的大小函数。单个元素的 GF 就是 $x_1^{e_1}x_2^{e_2}...$，比如 $T(12;x_1,x_2,...)=x_1^2x_2$。容易验证这个 GF 在“笛卡尔积”下积性。则我们有
$$
\mathcal F=\N\times\mathcal G
$$
考虑 $\N$ 的 GF，它当然是 $\prod_{i=1}^{\infty}\dfrac{1}{1-x_i}$。那么我们甚至不需要构造新的 $\mathcal Q$（事实上 $\mathcal F$ 就是我们想要的 $\mathcal Q$）就直接可以得到 $G=F\prod_{i=1}^{\infty}(1-x_i)$。而后面那个东西则是我们熟知的莫比乌斯函数。

这个例子不是很恰当，因为其实我们只是重新发明了狄利克雷生成函数而已。来个更劲爆的？